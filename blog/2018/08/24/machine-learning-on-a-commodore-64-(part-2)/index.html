<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0"><meta name="description" content="A blog for ongoing projects both professional and personal."><meta name="keywords" content="machine_learning,retro"><link href="/favicon.ico" rel="icon"><link href="http://fonts.googleapis.com/css?family=PT+Serif" rel="stylesheet" type="text/css"><link rel="stylesheet" type="text/css" href="/static/bower_components/sass-bootstrap/dist/css/bootstrap.min.css" media="all"><link rel="stylesheet" type="text/css" href="/static/css/style.min.css" media="all"><link rel="icon" type="image/png" href="/static/images/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/static/images/favicon-16x16.png" sizes="16x16"><link rel="alternate" type="application/rss+xml" title="What&#x27;s Up, Nick? - feed" href="http://feeds.feedburner.com/MatthewDalysBlog"><title>Machine Learning on a Commodore 64 (part 2) - What&#x27;s Up, Nick?</title></head><body><header><div class="container headercontainer"><div class="jumbotron"><h1><a href="/">What&#x27;s Up, Nick?</a></h1><h2>A blog for ongoing projects both professional and personal.</h2></div></div><div class="container headercontainer"><nav class="navbar navbar-inverse navbar-static-top"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#header-nav"><span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button><div class="collapse navbar-collapse" id="header-nav"><ul class="nav navbar-nav"><li><a href="/" style="color:white">Home</a></li><li><a href="/blog/archives/" style="color:white">Archives</a></li><li><a href="/contact-me/" style="color:white">Contact Me</a></li><li><a href="/about/" style="color:white">About</a></li><li><a href="/rss.xml" style="color:white">RSS</a></li></ul><form action="http://www.google.com/search" method="GET" name="searchForm" id="searchForm" enctype="application/x-www-form-urlencoded" class="navbar-form navbar-right"><div class="form-group"><input type="hidden" id="sitesearch" value=""> <input id="search" type="search" name="q" results="0" placeholder="Search..." maxlength="200" autocomplete="off" class="form-control"><ul class="searchresults"></ul></div></form></div></div></nav></div></header><div class="container"><div class="row"><div class="col-md-8"><article class="post"><p class="date">24th August 2018 5:08 am</p><h1>Machine Learning on a Commodore 64 (part 2)</h1><p><img src="/static/images/retro_posts/c64_learning/p2_intro.png" alt="The First Step"></p><p>If you’ll recall my first post on this subject you’ll remember I had wanted to start with coding a perceptron into a Commodore 64 emulator. Tonight, I tried to bring my mad experiment to life.</p><p>So, because I had absolutely no faith in my skills in BASIC V2 I wrote this code and tested it piecemeal. Write a little, run a little. With that in mind, I transcribed the first bit of my notepad code to the emulator:</p><p><img src="/static/images/retro_posts/c64_learning/p2_c1.png" alt="Code 01"></p><p>And the result?</p><p><img src="/static/images/retro_posts/c64_learning/p2_c2.png" alt="Not a Huge Surprise"></p><p>Not exactly a huge surprise. First off, it’s not “STEP:NEXT”, it’d just be “NEXT I” to denote a new I to continue the loop. With that fix the initialization of the bias and weights was put into place, now I could get focused on the data input. For the simplicity of the program, the data is user-defined.</p><p>I have it set up such that this has 6 nodes. The input has to be written as “010101” with quotes included. The numbers can be anything, but I tested with 1s and 0s. The code’s meant to take these 6 numbers as a string then break it up later into an array of 1 character strings that can be evaluated. Thus, the input was coded (with some effort, the name of the variable had to be changed. BASIC V2 isn’t fond of fancy variable names).</p><p><img src="/static/images/retro_posts/c64_learning/p2_c3.png" alt="Keep On Keeping On"></p><p>So, the input is a subroutine above the rest of the code. The idea is that I can take that block of code between 1 and 119 and make it into whatever I want later, so long as something is put in XINI$ and OUTE.</p><p>The next snag came from trying to actually break up the XINI$ string. The obvious choice was to use MID(x,y,z), which takes a string, x, and returns z characters starting at position y. So we could take our string, XINI$ as x, and iterate I from 0 to 5 to be our y, with z remaining as 1 so we can get each character one at a time. Except, woah there, cowboy. We run into another problem.</p><p><img src="/static/images/retro_posts/c64_learning/p2_c4.png" alt="More problems"></p><p>Type mismatch? What type mismatch? X$ is a string array. XINI$ is a string, so what’s the issue? Well, turns our MID(x,y,z) is for real numbers. If you want to do strings, you have to use MID$(x,y,z).</p><p><img src="/static/images/retro_posts/c64_learning/p2_c5.png" alt="Out of the Frying Pan into another Frying Pan"></p><p>Even after figuring THAT out, there’s another issue of an illegal quantity. This isn’t an array index going out of range, that’d come up as “BAD SUBSCRIPT”, this is something different. I started a new instance of the emulator to test the DIM X(Y) command to see how it worked.</p><p><img src="/static/images/retro_posts/c64_learning/p2_test1.png" alt="Machine Testing"></p><p>As expected, it’s 0-indexed. DIM X(50) has an index range of 0 to 50. Here you see I made an array of size 50 and show just that. X(99) and X(51) throw errors. So what’s the problem? Oh, just everyone’s favorite: Inconsistent array indexing. See, while calling a value from a DIM’d array is 0-indexed (ie X(0) is the first value), the MID(x,y,z) function decided to throw consistency to the wind and has the starting position value, y, be 1 indexed (ie MID(X,1,1) refers to the first value and MID(X,0,1) throws an error).</p><p><img src="/static/images/retro_posts/c64_learning/p2_c6.png" alt="Pile It On"></p><p>So, fine, have the for loop start from 1 and go to 6. Except X$, the array we’re breaking the string into, has to use I, too. So, no big deal, just do X$(I-1) instead, that’ll fix it, right? Well, yes, assuming you can find the subtraction symbol. This will probably be less of a problem on a real machine, but it can be a hassle on emulator.</p><p><img src="/static/images/retro_posts/c64_learning/p2_test2.png" alt="Machine Testing"></p><p>The formula above LOOKS right, but it produces incorrect output. Why? Because that’s not I-1. That’s I[Horizontal Line]1. For those not in the know, the Commodore 64 keyboard has a lot of keys and functions that don’t exist on a modern keyboard. This includes several graphical symbols that were used mostly to make graphics for games or for formatting documents. You’d draw out borders using line characters. Thing is, these line characters can look awfully similar to minus symbols if you’re not careful.</p><p><img src="/static/images/retro_posts/c64_learning/p2_c7.png" alt="What an Ordeal and a Half"></p><p>So finally we have our input broken down and we can move on. Next, we focus on the code that actually calculates the system’s answer given an input. Reading off of its weights and biases:</p><p><img src="/static/images/retro_posts/c64_learning/p2_c8.png" alt="Does it Work?"></p><p>Which results in…</p><p><img src="/static/images/retro_posts/c64_learning/p2_c9.png" alt="No, That&#39;s a hard No"></p><p>Once again I’m getting too fancy with these variable names. X, Y and Z variables never killed anyone, I suppose. The lack of room for comments makes it even worse, this’ll be hard to understand in the future. Total is now Y. I go ahead and change ‘ANSWER’ to Z.</p><p><img src="/static/images/retro_posts/c64_learning/p2_c10.png" alt="Fixed Up"></p><p>Finally, we can zip through the code for updating the biases. Following the Perceptron algorithm, it only updates the weights if the answer was wrong. IE if OUTE != Z. Granted, the weights might be updated even if the system got the problem right if OUTE = 2 (which means we’re testing). This can be fixed in future.</p><p><img src="/static/images/retro_posts/c64_learning/p2_c11.png" alt="Home Stretch"></p><p>Running this, everything seems to be working fine until we attempt another pass of data, where we run into this:</p><p><img src="/static/images/retro_posts/c64_learning/p2_c12.png" alt="One Final Hurdle"></p><p>Right, I had read this, a DIM’d array can’t be re-DIM’d. So, who says we can’t just DIM X$ once at the top of the code? Every pass-through it gets completely overwritten anyway. With that last touch, the program runs in full:</p><p><img src="/static/images/retro_posts/c64_learning/p2_final_test.png" alt="What We Have So Far"></p><p>Is it really learning? It’s hard to say. It got its training examples 2/3, though it could just be outputting 0 every time. Print statements are kind of a pain on these old systems, which I’m sure is easy to see. Next time we’ll dig deeper into this thing and see what we can improve. Namely, we’ll try to add some metric in order to keep track of how well our C64 Perceptron is doing as more data is added. In addition, a new Data entry method is required. We’ll also need PRINT statements to see if there’s any errors under the hood.</p><p>I’ll be throwing up my CCS64 Savestate onto github along with my BASIC code in a txt document into a repository on GitHub.<br>~Nicko</p><ul class="categorylist"><li><a href="/blog/categories/machine_learning/">machine_learning</a></li><li><a href="/blog/categories/retro/">retro</a></li></ul><section class="comments"></section></article></div><div class="col-md-4"><a href="https://github.com/NickRCasteen"><img src="/static/images/My_Git.png" alt="My Github!" style="width:350px;height:120px;border:0;"></a><h4>Recent Projects:</h4><ul id="github-repos"><li><a href="https://github.com/NickRCasteen/stockPortfolioApp" style="color:blue">Stock Portfolio App</a> [Completed!]</li><li><a href="https://github.com/NickRCasteen/Programming_Challenges" style="color:blue">Programming Challenges</a> [Ongoing!]</li><li><a href="https://github.com/NickRCasteen/NickRCasteen.github.io" style="color:blue">My Website</a> [In Progress!]</li><li><a href="https://github.com/NickRCasteen/C64_Machine_Learning" style="color:blue">C64 Machine Learning</a> [New!]</li></ul></div></div><div class="row"><div class="col-md-12"><ul class="pager"><li><a href="/blog/2018/08/23/programming-challenges-(part-1-knuth-arrow)/">Programming Challenges (part 1 - Knuth Arrow)</a></li></ul></div></div></div><footer><div class="container footercontainer"><div class="col-md-12"><p class="copyright">Copyright &copy; Nicholas Casteen 2018.</p></div></div></footer><script type="text/javascript" src="/static/js/all.min.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='//www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-XXXXX-X');ga('send','pageview');</script></body></html>